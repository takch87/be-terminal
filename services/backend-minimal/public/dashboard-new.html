<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeTerminal Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 1400px; margin: 0 auto; background: white;
            border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; padding: 30px; text-align: center;
        }
        
        /* Tab Navigation */
        .tab-nav {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }
        .tab-btn {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .tab-btn.active {
            background: white;
            border-bottom-color: #667eea;
            color: #667eea;
            font-weight: bold;
        }
        .tab-btn:hover {
            background: #e9ecef;
        }
        
        /* Tab Content */
        .tab-content {
            display: none;
            padding: 30px;
        }
        .tab-content.active {
            display: block;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px; 
            margin-bottom: 30px;
        }
        .stat-card {
            background: white; 
            border-radius: 10px; 
            padding: 25px; 
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
            transition: transform 0.3s ease;
            border: 1px solid #e9ecef;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .stat-number { 
            font-size: 2.5em; 
            font-weight: bold; 
            margin-bottom: 10px; 
            color: #667eea;
        }
        
        /* Buttons */
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            border: none; 
            padding: 12px 25px; 
            border-radius: 25px;
            cursor: pointer; 
            font-size: 1em; 
            margin: 5px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #495057;
        }
        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 1em;
        }
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.25);
        }
        
        /* Config Cards */
        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        .config-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border: 1px solid #e9ecef;
        }
        .config-card h3 {
            color: #495057;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .processor-icon {
            width: 30px;
            height: 30px;
            margin-right: 10px;
            border-radius: 5px;
        }
        
        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .table th,
        .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        .table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #495057;
        }
        .table tr:hover {
            background: #f8f9fa;
        }
        
        /* Status badges */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
        }
        .status-succeeded { background: #d4edda; color: #155724; }
        .status-failed { background: #f8d7da; color: #721c24; }
        .status-pending { background: #fff3cd; color: #856404; }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            border-radius: 15px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .close {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }
        .close:hover { color: #000; }
        
        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }
        
        /* Success/Error messages */
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí≥ BeTerminal Dashboard</h1>
            <p>Panel de control multi-procesador</p>
        </div>
        
        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="openTab(event, 'overview')">üìä Overview</button>
            <button class="tab-btn" onclick="openTab(event, 'transactions')">üìã Transacciones</button>
            <button class="tab-btn" onclick="openTab(event, 'events')">üé´ Eventos</button>
            <button class="tab-btn" onclick="openTab(event, 'users')">üë• Usuarios</button>
            <button class="tab-btn" onclick="openTab(event, 'payment-config')">‚öôÔ∏è Payment Config</button>
        </div>
        
        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <h2>üìä Resumen General</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-transactions">-</div>
                    <div>Transacciones Totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-amount">-</div>
                    <div>Monto Total ($)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="successful-transactions">-</div>
                    <div>Exitosas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="failed-transactions">-</div>
                    <div>Fallidas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-users">-</div>
                    <div>Usuarios</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-events">-</div>
                    <div>Eventos</div>
                </div>
            </div>
            
            <div>
                <h3>üí≥ Procesadores Activos</h3>
                <div id="processors-status" class="loading">Cargando...</div>
            </div>
        </div>
        
        <!-- Transactions Tab -->
        <div id="transactions" class="tab-content">
            <h2>üìã Transacciones</h2>
            <button class="btn" onclick="loadTransactions()">üîÑ Actualizar</button>
            <div id="transactions-container" class="loading">Cargando transacciones...</div>
        </div>
        
        <!-- Events Tab -->
        <div id="events" class="tab-content">
            <h2>üé´ Gesti√≥n de Eventos</h2>
            <button class="btn" onclick="loadEvents()">üîÑ Actualizar</button>
            <button class="btn btn-secondary" onclick="showCreateEventModal()">‚ûï Crear Evento</button>
            <div id="events-container" class="loading">Cargando eventos...</div>
        </div>
        
        <!-- Users Tab -->
        <div id="users" class="tab-content">
            <h2>üë• Usuarios</h2>
            <button class="btn" onclick="loadUsers()">üîÑ Actualizar</button>
            <div id="users-container" class="loading">Cargando usuarios...</div>
        </div>
        
        <!-- Payment Config Tab -->
        <div id="payment-config" class="tab-content">
            <h2>‚öôÔ∏è Configuraci√≥n de Procesadores de Pago</h2>
            <div id="payment-processors-config" class="loading">Cargando configuraciones...</div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('eventModal')">&times;</span>
            <h2>‚ûï Crear Nuevo Evento</h2>
            <form id="eventForm">
                <div class="form-group">
                    <label class="form-label">C√≥digo del Evento:</label>
                    <input type="text" class="form-control" id="eventCode" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Nombre:</label>
                    <input type="text" class="form-control" id="eventName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Descripci√≥n:</label>
                    <textarea class="form-control" id="eventDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Procesador de Pago:</label>
                    <select class="form-control" id="eventProcessor" required>
                        <option value="">Seleccionar procesador...</option>
                    </select>
                </div>
                <button type="submit" class="btn">Crear Evento</button>
            </form>
        </div>
    </div>
    
    <div id="configModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('configModal')">&times;</span>
            <h2 id="configModalTitle">‚öôÔ∏è Configurar Procesador</h2>
            <div id="configModalContent"></div>
        </div>
    </div>

    <script>
        let currentProcessor = null;
        let processors = [];
        
        // Tab functionality
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            tablinks = document.getElementsByClassName("tab-btn");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
            
            // Load data when tab is opened
            if (tabName === 'transactions') loadTransactions();
            if (tabName === 'events') loadEvents();
            if (tabName === 'users') loadUsers();
            if (tabName === 'payment-config') loadPaymentConfig();
        }
        
        // Modal functionality
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Load overview data
        async function loadOverview() {
            try {
                // Load stats
                const statsResponse = await fetch('/api/dashboard/stats');
                const stats = await statsResponse.json();
                
                document.getElementById('total-transactions').textContent = stats.totalTransactions || 0;
                document.getElementById('total-amount').textContent = ((stats.totalAmount || 0) / 100).toFixed(2);
                document.getElementById('successful-transactions').textContent = stats.successfulTransactions || 0;
                document.getElementById('failed-transactions').textContent = stats.failedTransactions || 0;
                
                // Load users count
                const usersResponse = await fetch('/api/dashboard/users');
                const users = await usersResponse.json();
                document.getElementById('total-users').textContent = users.length;
                
                // Load events count
                const eventsResponse = await fetch('/api/dashboard/events');
                const events = await eventsResponse.json();
                document.getElementById('total-events').textContent = events.length;
                
                // Load processors status
                await loadProcessorsStatus();
                
            } catch (error) {
                console.error('Error loading overview:', error);
            }
        }
        
        // Load processors status
        async function loadProcessorsStatus() {
            try {
                const response = await fetch('/api/payment/processors');
                const data = await response.json();
                
                if (data.success) {
                    processors = data.processors;
                    const container = document.getElementById('processors-status');
                    
                    if (processors.length === 0) {
                        container.innerHTML = '<p>‚ùå No hay procesadores configurados</p>';
                        return;
                    }
                    
                    const html = processors.map(processor => 
                        `<div class="stat-card" style="display: inline-block; margin: 10px;">
                            <div style="font-size: 1.2em; margin-bottom: 10px;">
                                ${processor.name === 'stripe' ? 'üí≥' : 'üè¶'} ${processor.display_name}
                            </div>
                            <div style="color: #28a745; font-weight: bold;">‚úÖ Activo</div>
                        </div>`
                    ).join('');
                    
                    container.innerHTML = html;
                } else {
                    document.getElementById('processors-status').innerHTML = '<p>‚ùå Error cargando procesadores</p>';
                }
            } catch (error) {
                console.error('Error loading processors:', error);
                document.getElementById('processors-status').innerHTML = '<p>‚ùå Error de conexi√≥n</p>';
            }
        }
        
        // Load transactions
        async function loadTransactions() {
            try {
                const response = await fetch('/api/dashboard/transactions');
                const transactions = await response.json();
                
                const container = document.getElementById('transactions-container');
                
                if (transactions.length === 0) {
                    container.innerHTML = '<p class="loading">üì≠ No hay transacciones</p>';
                    return;
                }
                
                const html = `
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Monto</th>
                                <th>Estado</th>
                                <th>Evento</th>
                                <th>Procesador</th>
                                <th>Fecha</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${transactions.map(tx => `
                                <tr>
                                    <td>${tx.transaction_id || 'N/A'}</td>
                                    <td>$${((tx.amount || 0) / 100).toFixed(2)}</td>
                                    <td><span class="status-badge status-${tx.status}">${tx.status}</span></td>
                                    <td>${tx.event_code || 'N/A'}</td>
                                    <td>${tx.processor_type || 'stripe'}</td>
                                    <td>${new Date(tx.created_at).toLocaleDateString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading transactions:', error);
                document.getElementById('transactions-container').innerHTML = '<p class="alert alert-error">‚ùå Error cargando transacciones</p>';
            }
        }
        
        // Load events
        async function loadEvents() {
            try {
                const response = await fetch('/api/dashboard/events-with-processors');
                const events = await response.json();
                
                const container = document.getElementById('events-container');
                
                if (events.length === 0) {
                    container.innerHTML = '<p class="loading">üì≠ No hay eventos</p>';
                    return;
                }
                
                const html = `
                    <table class="table">
                        <thead>
                            <tr>
                                <th>C√≥digo</th>
                                <th>Nombre</th>
                                <th>Descripci√≥n</th>
                                <th>Procesador</th>
                                <th>Creador</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${events.map(event => `
                                <tr>
                                    <td><strong>${event.code}</strong></td>
                                    <td>${event.name}</td>
                                    <td>${event.description || 'N/A'}</td>
                                    <td>
                                        <select onchange="updateEventProcessor(${event.id}, this.value)">
                                            ${processors.map(p => 
                                                `<option value="${p.id}" ${p.id == event.processor_id ? 'selected' : ''}>
                                                    ${p.display_name}
                                                </option>`
                                            ).join('')}
                                        </select>
                                    </td>
                                    <td>${event.creator_name || 'N/A'}</td>
                                    <td>
                                        <button class="btn" onclick="editEvent(${event.id})">‚úèÔ∏è</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading events:', error);
                document.getElementById('events-container').innerHTML = '<p class="alert alert-error">‚ùå Error cargando eventos</p>';
            }
        }
        
        // Load users
        async function loadUsers() {
            try {
                const response = await fetch('/api/dashboard/users');
                const users = await response.json();
                
                const container = document.getElementById('users-container');
                
                if (users.length === 0) {
                    container.innerHTML = '<p class="loading">üì≠ No hay usuarios</p>';
                    return;
                }
                
                const html = `
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Fecha de Registro</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${users.map(user => `
                                <tr>
                                    <td>${user.id}</td>
                                    <td><strong>${user.username}</strong></td>
                                    <td>${new Date(user.created_at).toLocaleDateString()}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading users:', error);
                document.getElementById('users-container').innerHTML = '<p class="alert alert-error">‚ùå Error cargando usuarios</p>';
            }
        }
        
        // Load payment configuration
        async function loadPaymentConfig() {
            try {
                const response = await fetch('/api/payment/processors');
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error('Error loading processors');
                }
                
                processors = data.processors;
                const container = document.getElementById('payment-processors-config');
                
                const html = `
                    <div class="config-grid">
                        ${processors.map(processor => `
                            <div class="config-card">
                                <h3>
                                    <div class="processor-icon" style="background: ${processor.name === 'stripe' ? '#635bff' : '#00A3E4'};">
                                        ${processor.name === 'stripe' ? 'üí≥' : 'üè¶'}
                                    </div>
                                    ${processor.display_name}
                                </h3>
                                <p>${processor.description}</p>
                                <div style="margin-top: 20px;">
                                    <button class="btn" onclick="configureProcessor('${processor.name}', false)">
                                        ‚öôÔ∏è Configurar Producci√≥n
                                    </button>
                                    <button class="btn btn-secondary" onclick="configureProcessor('${processor.name}', true)">
                                        üß™ Configurar Test
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.innerHTML = html;
            } catch (error) {
                console.error('Error loading payment config:', error);
                document.getElementById('payment-processors-config').innerHTML = '<p class="alert alert-error">‚ùå Error cargando configuraci√≥n</p>';
            }
        }
        
        // Configure processor
        async function configureProcessor(processorName, testMode) {
            currentProcessor = { name: processorName, testMode };
            
            try {
                // Load current config
                const response = await fetch(`/api/payment/config/${processorName}?test_mode=${testMode}`);
                const data = await response.json();
                
                const title = `‚öôÔ∏è Configurar ${processorName.charAt(0).toUpperCase() + processorName.slice(1)} - ${testMode ? 'Test' : 'Producci√≥n'}`;
                document.getElementById('configModalTitle').textContent = title;
                
                let configHTML = '';
                
                if (processorName === 'stripe') {
                    configHTML = `
                        <form id="processorConfigForm">
                            <div class="form-group">
                                <label class="form-label">Publishable Key:</label>
                                <input type="text" class="form-control" name="publishable_key" 
                                       placeholder="pk_${testMode ? 'test' : 'live'}_..." 
                                       value="${data.config?.publishable_key?.endsWith('...') ? '' : data.config?.publishable_key || ''}" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Secret Key:</label>
                                <input type="password" class="form-control" name="secret_key" 
                                       placeholder="sk_${testMode ? 'test' : 'live'}_..." required>
                            </div>
                            <button type="submit" class="btn">üíæ Guardar Configuraci√≥n</button>
                        </form>
                    `;
                } else if (processorName === 'adyen') {
                    configHTML = `
                        <form id="processorConfigForm">
                            <div class="form-group">
                                <label class="form-label">API Key:</label>
                                <input type="password" class="form-control" name="api_key" 
                                       placeholder="AQE..." required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Merchant Account:</label>
                                <input type="text" class="form-control" name="merchant_account" 
                                       placeholder="YourMerchantAccount" 
                                       value="${data.config?.merchant_account || ''}" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">HMAC Key (para webhooks):</label>
                                <input type="password" class="form-control" name="hmac_key" 
                                       placeholder="HMAC key for webhook verification">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Return URL:</label>
                                <input type="url" class="form-control" name="return_url" 
                                       placeholder="https://be.terminal.beticket.net/payment/return"
                                       value="${data.config?.return_url || 'https://be.terminal.beticket.net/payment/return'}">
                            </div>
                            <button type="submit" class="btn">üíæ Guardar Configuraci√≥n</button>
                        </form>
                    `;
                }
                
                document.getElementById('configModalContent').innerHTML = configHTML;
                
                // Add form submission handler
                document.getElementById('processorConfigForm').addEventListener('submit', saveProcessorConfig);
                
                showModal('configModal');
                
            } catch (error) {
                console.error('Error loading processor config:', error);
                alert('Error cargando configuraci√≥n del procesador');
            }
        }
        
        // Save processor configuration
        async function saveProcessorConfig(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const config = Object.fromEntries(formData.entries());
            
            try {
                const response = await fetch(`/api/payment/config/${currentProcessor.name}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + localStorage.getItem('token')
                    },
                    body: JSON.stringify({
                        ...config,
                        test_mode: currentProcessor.testMode
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ Configuraci√≥n guardada exitosamente');
                    closeModal('configModal');
                    loadPaymentConfig();
                    loadProcessorsStatus();
                } else {
                    alert('‚ùå Error: ' + result.error);
                }
            } catch (error) {
                console.error('Error saving config:', error);
                alert('‚ùå Error guardando configuraci√≥n');
            }
        }
        
        // Update event processor
        async function updateEventProcessor(eventId, processorId) {
            try {
                const response = await fetch(`/api/events/${eventId}/processor`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + localStorage.getItem('token')
                    },
                    body: JSON.stringify({ processor_id: processorId })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    console.log('‚úÖ Procesador de evento actualizado');
                } else {
                    alert('‚ùå Error: ' + result.error);
                    loadEvents(); // Reload to reset select
                }
            } catch (error) {
                console.error('Error updating event processor:', error);
                alert('‚ùå Error actualizando procesador del evento');
                loadEvents(); // Reload to reset select
            }
        }
        
        // Show create event modal
        function showCreateEventModal() {
            // Populate processor select
            const select = document.getElementById('eventProcessor');
            select.innerHTML = '<option value="">Seleccionar procesador...</option>' +
                processors.map(p => `<option value="${p.id}">${p.display_name}</option>`).join('');
            
            showModal('eventModal');
        }
        
        // Initialize dashboard
        async function initDashboard() {
            // Check authentication
            const token = localStorage.getItem('token');
            if (!token) {
                window.location.href = '/login';
                return;
            }
            
            // Set auth header for all requests
            const originalFetch = window.fetch;
            window.fetch = function(url, options = {}) {
                if (!options.headers) options.headers = {};
                options.headers['Authorization'] = 'Bearer ' + token;
                return originalFetch(url, options);
            };
            
            // Load initial data
            await loadOverview();
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initDashboard);
        
        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            }
        }
    </script>
</body>
</html>
